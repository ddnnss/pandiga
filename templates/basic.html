{% load static %}
<!DOCTYPE html>
<!-- SKIBORG WAS HERE -->
<html lang="ru">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta charset="UTF-8">
    <title>index</title>

    <link rel="stylesheet" href="{% static 'css/font-awesome.css' %}">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/nouislider.css' %}">
      <link rel="stylesheet" href="{% static 'css/tiny-slider.css' %}">
</head>
<body>
<form style="display: none" id="dummy_form" >{% csrf_token %}</form>
{% include 'header.html' %}
{% block content %}
{% endblock %}
{% include 'footer.html' %}

{% block js %}
    <script>
     let csrfmiddlewaretoken = document.getElementsByName('csrfmiddlewaretoken')[0].value
      let cityId = document.getElementById('city_id')
       function openModal() {
            document.getElementsByClassName('modal')[0].classList.toggle('modal-active')
        }
    </script>
     <!-- getCities-->
    <script>
    function getCities(el) {
        let citySelectList = document.getElementById('city_select_list')

        if (el.value.length <= 2){
            console.log('too small')
             cityId.value = 'all'
            return
        }else{
            console.log(el.value)
            el.disabled = true
            let body = {'query':el.value}
            fetch('/get_city/', {
                method: 'post',
                body: JSON.stringify(body),
                headers: { "X-CSRFToken": csrfmiddlewaretoken },
                credentials: 'same-origin'
            }).then(res=>res.json())
                .then(res => {
                    console.log(res)
                    el.disabled = false
                    el.focus()
                    if (res.length >= 1){
                        citySelectList.innerHTML = ''
                        for(i of res){

                            citySelectList.innerHTML = citySelectList.innerHTML +
                                `<p data-id="${i['id']}" data-city="${i['city']}" data-region="${i['region']}" class="city-select-list-item" onclick="setCity(this)">
                                 ${i['city']}
                                 <span>${i['region']}</span>
                             </p>`
                        }
                        citySelectList.classList.add('list-active')
                    }else{
                        citySelectList.classList.remove('list-active')
                    }

                })
        }

    }
    function setCity(el) {
        let citySelectInput = document.getElementById('city_select_input')
        let citySelectList = document.getElementById('city_select_list')

        citySelectList.classList.remove('list-active')
        citySelectInput.value = `${el.dataset.region}, ${el.dataset.city}`
        cityId.value = el.dataset.id
    }
    </script>
    <!-- //getCities-->

    <!-- tabs-->
    <script>
       function openHTab(evt, tabName) {
            let i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("h-tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("h-tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" htab-active", "");
            }
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " htab-active";
        }
       function opentab(evt, TabName, type) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("lk-tab");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(` ${type}`, "");
            }
            document.getElementById(TabName).style.display = "block";

            console.log(evt)
            evt.currentTarget.className += ` ${type}`;
            closeChat()
        }
    </script>
    <!-- //tabs-->
{% endblock %}
</body>
</html>